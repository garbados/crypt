!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Crypt=e()}(function(){return function r(o,i,c){function a(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return a(o[t][1][e]||e)},n,n.exports,r,o,i,c)}return i[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)a(c[e]);return a}({1:[function(m,v,e){!function(e,b){!function(){const{encodeBase64:t,decodeBase64:n}=m("tweetnacl-util"),c=16,a=16;function u(e){return new TextEncoder("utf8").encode(e)}function o(e,t){return(e,t)=>{e?o(e):r(t)}}function f(e,...t){throw t.includes(e.message)?new Error("Could not decrypt!"):e}let r,i;try{i=window&&window.crypto}catch{}if(!i)try{i=e&&e.crypto}catch{}if(i=i||m("crypto").webcrypto,i){const{subtle:l,getRandomValues:y}=i,p="AES-GCM",w="PBKDF2";async function s(e){const t=new Uint8Array(e);return y.call(i,t)}async function d(e,t){return l.deriveKey({name:w,salt:t,iterations:1e4,hash:"SHA-256"},e,{name:p,length:256},!0,["encrypt","decrypt"])}r={getKeyFromPassword:async function(e){return l.importKey("raw",u(e),w,!1,["deriveKey"])},encrypt:async function(e,t){var n=await s(c),r=await s(a),o=await d(e,r),e=u(t),t={name:p,iv:n},e=await l.encrypt(t,o,e);const i=new Uint8Array(n.length+r.length+e.byteLength);return i.set(n),i.set(r,n.length),i.set(new Uint8Array(e),n.length+r.length),i},decrypt:async function(e,t){var n=t.slice(0,c),r=t.slice(c,32),t=t.slice(32),r=await d(e,r),n={name:p,iv:n};try{return await l.decrypt(n,r,t)}catch(e){f(e,"Cipher job failed","")}}}}else{const h=m("crypto"),g="AES-256-GCM";async function s(i){return new Promise((e,t)=>{const n=(r=e,o=t,(e,t)=>{e?o(e):r(t)});var r,o;h.randomBytes(i,n)})}r={getKeyFromPassword:async function(t){return e=>async function(n,r){return new Promise((e,t)=>{t=o(e,t);h.pbkdf2(n,r,1e4,32,"sha256",t)})}(t,e)},encrypt:async function(e,t){var n=await s(c),r=await s(a),e=await e(r);const o=h.createCipheriv(g,e,n);e=b.concat([o.update(t),o.final()]),t=o.getAuthTag();return b.concat([n,r,e,t])},decrypt:async function(e,t){var n=t.slice(0,c),r=t.slice(c,32),o=t.slice(32,t.length-16),t=t.slice(t.length-16),r=await e(r);try{const i=h.createDecipheriv(g,r,n);return i.setAuthTag(t),b.concat([i.update(o),i.final()])}catch(e){f(e,"Unsupported state or unable to authenticate data")}}}}v.exports=class{constructor(e){if(!e)throw new Error("A password is required for encryption or decryption.");this._pending=r.getKeyFromPassword(e).then(e=>{this._key=e})}async encrypt(e){await this._pending;e=await r.encrypt(this._key,e);return t(e)}async decrypt(e){await this._pending;e=n(e),e=await r.decrypt(this._key,e);return e=e,new TextDecoder("utf8").decode(e)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},m("buffer").Buffer)},{buffer:"buffer",crypto:"crypto","tweetnacl-util":2}],2:[function(e,n,t){!function(t){!function(){!function(e,t){"use strict";void 0!==n&&n.exports?n.exports=t():(e.nacl||(e.nacl={}),e.nacl.util=t())}(this,function(){"use strict";var e={};function o(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");for(var t=unescape(encodeURIComponent(e)),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},e.encodeUTF8=function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return decodeURIComponent(escape(t.join("")))},"undefined"==typeof atob?void 0!==t.from?(e.encodeBase64=function(e){return t.from(e).toString("base64")},e.decodeBase64=function(e){return o(e),new Uint8Array(Array.prototype.slice.call(t.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new t(e).toString("base64")},e.decodeBase64=function(e){return o(e),new Uint8Array(Array.prototype.slice.call(new t(e,"base64"),0))}):(e.encodeBase64=function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(String.fromCharCode(e[r]));return btoa(t.join(""))},e.decodeBase64=function(e){o(e);for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}),e})}.call(this)}.call(this,e("buffer").Buffer)},{buffer:"buffer"}]},{},[1])(1)});