!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Crypt=e()}(function(){return function r(o,i,a){function c(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return c(o[t][1][e]||e)},n,n.exports,r,o,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)c(a[e]);return c}({1:[function(m,b,e){!function(e,g){!function(){const{encodeBase64:t,decodeBase64:n}=m("tweetnacl-util"),a="Could not decrypt!",c=16,s=16;function u(e){return new TextEncoder("utf8").encode(e)}let r,o;try{o=window&&window.crypto}catch{}if(!o)try{o=e&&e.crypto}catch{}if(o=o||m("crypto").webcrypto,o){const{subtle:y,getRandomValues:i}=o,l="AES-GCM",p="PBKDF2";async function f(e){const t=new Uint8Array(e);return i.call(o,t)}async function d(e,t){return y.deriveKey({name:p,salt:t,iterations:1e4,hash:"SHA-256"},e,{name:l,length:256},!0,["encrypt","decrypt"])}r={getKeyFromPassword:async function(e){return y.importKey("raw",u(e),p,!1,["deriveKey"])},encrypt:async function(e,t){var n=await f(c),r=await f(s),o=await d(e,r),e=u(t),t={name:l,iv:n},e=await y.encrypt(t,o,e);const i=new Uint8Array(n.length+r.length+e.byteLength);return i.set(n),i.set(r,n.length),i.set(new Uint8Array(e),n.length+r.length),i},decrypt:async function(e,t){var n=t.slice(0,c),r=t.slice(c,32),t=t.slice(32),r=await d(e,r),n={name:l,iv:n};try{return await y.decrypt(n,r,t)}catch(e){throw"Cipher job failed"===e.message||""===e.message?new Error(a):e}}}}else{const w=m("crypto"),h="AES-256-GCM";async function f(t){return new Promise((n,r)=>{const e=(e,t)=>{e?r(e):n(t)};w.randomBytes(t,e)})}r={getKeyFromPassword:async function(t){return e=>async function(e,t){return new Promise((n,r)=>{w.pbkdf2(e,t,1e4,32,"sha256",(e,t)=>{e?r(e):n(t)})})}(t,e)},encrypt:async function(e,t){var n=await f(c),r=await f(s),e=await e(r);const o=w.createCipheriv(h,e,n);e=g.concat([o.update(t),o.final()]),t=o.getAuthTag();return g.concat([n,r,e,t])},decrypt:async function(e,t){var n=t.slice(0,c),r=t.slice(c,32),o=t.slice(32,t.length-16),t=t.slice(t.length-16),r=await e(r);try{const i=w.createDecipheriv(h,r,n);return i.setAuthTag(t),g.concat([i.update(o),i.final()])}catch(e){throw"Unsupported state or unable to authenticate data"===e.message?new Error(a):e}}}}b.exports=class{constructor(e){if(!e)throw new Error("A password is required for encryption or decryption.");this._pending=r.getKeyFromPassword(e).then(e=>{this._key=e})}async encrypt(e){await this._pending;e=await r.encrypt(this._key,e);return t(e)}async decrypt(e){await this._pending;e=n(e),e=await r.decrypt(this._key,e);return e=e,new TextDecoder("utf8").decode(e)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},m("buffer").Buffer)},{buffer:"buffer",crypto:"crypto","tweetnacl-util":2}],2:[function(e,n,t){!function(t){!function(){!function(e,t){"use strict";void 0!==n&&n.exports?n.exports=t():(e.nacl||(e.nacl={}),e.nacl.util=t())}(this,function(){"use strict";var e={};function o(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");for(var t=unescape(encodeURIComponent(e)),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},e.encodeUTF8=function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return decodeURIComponent(escape(t.join("")))},"undefined"==typeof atob?void 0!==t.from?(e.encodeBase64=function(e){return t.from(e).toString("base64")},e.decodeBase64=function(e){return o(e),new Uint8Array(Array.prototype.slice.call(t.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new t(e).toString("base64")},e.decodeBase64=function(e){return o(e),new Uint8Array(Array.prototype.slice.call(new t(e,"base64"),0))}):(e.encodeBase64=function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(String.fromCharCode(e[r]));return btoa(t.join(""))},e.decodeBase64=function(e){o(e);for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}),e})}.call(this)}.call(this,e("buffer").Buffer)},{buffer:"buffer"}]},{},[1])(1)});